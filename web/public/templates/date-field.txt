"use client";

import type {
  DateFieldProps as AriaDateFieldProps,
  DateValue,
} from "react-aria-components";
import {
  DateField as AriaDateField,
  DateInput,
  DateSegment,
  FieldError,
  Label,
  Text,
} from "react-aria-components";
import { tv } from "tailwind-variants";

const dateField = tv({
  slots: {
    input:
      "flex w-fit min-w-sm whitespace-nowrap rounded-md border border-border p-2 outline-none ring-fg focus-within:border-transparent focus-within:ring-2",
    segmentStyles:
      "rounded-md p-1 text-end outline-none focus:bg-secondary focus:text-secondary-fg",
  },
});

const styles = dateField();

interface DateFieldProps<T extends DateValue> extends AriaDateFieldProps<T> {
  label?: string;
  description?: string;
  errorMessage?: string;
}

const DateField = <T extends DateValue>({
  label,
  description,
  errorMessage,
  ...props
}: DateFieldProps<T>) => (
  <AriaDateField className="flex flex-col gap-2" {...props}>
    {label && <Label className="text-sm">{label}</Label>}
    <DateInput className={styles.input()}>
      {(segment) => (
        <DateSegment className={styles.segmentStyles()} segment={segment} />
      )}
    </DateInput>
    {description && <Text slot="description">{description}</Text>}
    <FieldError className="text-critical text-sm">{errorMessage}</FieldError>
  </AriaDateField>
); 

export { DateField };
export type { DateFieldProps };
